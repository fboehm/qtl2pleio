---
title: "Benchmarking"
author: "Frederick Boehm"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Benchmarking}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```


The goal here is to compare the computational time for `calc_Bhat`, where the calculations are done in R, with that of `rcpp_calc_Bhat` &   `rcpp_calc_Bhat2`, where the calculations are done in C++.

```{r}
library(qtl2pleio)

X1 <- as.matrix(rbinom(n = 100, size = 1, prob = 1 / 2))
X <- gemma2::stagger_mats(X1, X1)
Sigma_inv <- diag(200)
Y <- runif(200)
calc_Bhat(X, Sigma_inv, Y)

microbenchmark::microbenchmark(
  calc_Bhat(X = X, Sigma_inv = Sigma_inv, Y = Y), 
  rcpp_calc_Bhat2(X = X, Y = Y, Sigma_inv = Sigma_inv),
  rcpp_calc_Bhat(X = X, Sigma = Sigma_inv, Y = Y)
)

```

