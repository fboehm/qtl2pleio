<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Comparing covariance estimates between <code>limmbo2</code> and <code>gemma2</code> • qtl2pleio</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Comparing covariance estimates between &lt;code&gt;limmbo2&lt;/code&gt; and &lt;code&gt;gemma2&lt;/code&gt;">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">qtl2pleio</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Comparing_covariance_estimates_with_those_of_gemma2.html">Comparing covariance estimates between `limmbo2` and `gemma2`</a>
    </li>
    <li>
      <a href="../articles/testing-close-linkage-vs-pleiotropy.html">Testing close linkage v. pleiotropy</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/fboehm/qtl2pleio">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Comparing covariance estimates between <code>limmbo2</code> and <code>gemma2</code>
</h1>
                        <h4 class="author">Frederick Boehm</h4>
            
            <h4 class="date">2018-04-10</h4>
      
      <small>Source: <a href="https://github.com/fboehm/qtl2pleio/blob/master/vignettes/Comparing_covariance_estimates_with_those_of_gemma2.Rmd"><code>vignettes/Comparing_covariance_estimates_with_those_of_gemma2.Rmd</code></a></small>
      <p class="hidden name"><code>Comparing_covariance_estimates_with_those_of_gemma2.Rmd</code></p>

    </div>

    
    
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<p><a href="https://github.com/fboehm/gemma2"><code>gemma2</code></a> is an R implementation of the C++ code for EM-based estimation of Vg and Ve. <code>limmbo2</code> is a R wrapper to the <a href="https://github.com/HannahVMeyer/limmbo"><code>limmbo</code></a> python module.</p>
</div>
<div id="goals" class="section level2">
<h2 class="hasAnchor">
<a href="#goals" class="anchor"></a>Goals</h2>
<p>I want to see how similar the variance component estimates are for the two methods. Recall that it’s the function <code><a href="../reference/calc_covs.html">qtl2pleio::calc_covs</a></code> that I want to use to get the estimates based on gemma2’s EM algorithm. limmbo2() in the limmbo2 R package will provide both Vg and Ve.</p>
</div>
<div id="first-gemma2-method" class="section level2">
<h2 class="hasAnchor">
<a href="#first-gemma2-method" class="anchor"></a>First, <code>gemma2</code> method:</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(qtl2pleio)
pheno &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">300</span>), <span class="dt">nrow =</span> <span class="dv">100</span>)
kinship &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="dv">100</span>)
<span class="kw"><a href="../reference/calc_covs.html">calc_covs</a></span>(pheno, kinship)
<span class="co">#&gt; $Vg</span>
<span class="co">#&gt;             [,1]        [,2]       [,3]</span>
<span class="co">#&gt; [1,]  0.50239323 -0.01022838 0.02932348</span>
<span class="co">#&gt; [2,] -0.01022838  0.47537629 0.01450993</span>
<span class="co">#&gt; [3,]  0.02932348  0.01450993 0.40361547</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Ve</span>
<span class="co">#&gt;             [,1]        [,2]       [,3]</span>
<span class="co">#&gt; [1,]  0.50239323 -0.01022838 0.02932348</span>
<span class="co">#&gt; [2,] -0.01022838  0.47537629 0.01450993</span>
<span class="co">#&gt; [3,]  0.02932348  0.01450993 0.40361547</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(limmbo2)
<span class="kw"><a href="http://www.rdocumentation.org/packages/limmbo2/topics/limmbo2">limmbo2</a></span>(<span class="dt">kinship =</span> kinship, <span class="dt">pheno =</span> pheno, <span class="dt">seed =</span> <span class="dv">1</span>)
<span class="co">#&gt; $Vg</span>
<span class="co">#&gt;              [,1]         [,2]       [,3]</span>
<span class="co">#&gt; [1,]  0.497632305 -0.009076269 0.02899449</span>
<span class="co">#&gt; [2,] -0.009076269  0.474030013 0.01427275</span>
<span class="co">#&gt; [3,]  0.028994487  0.014272753 0.39957497</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Ve</span>
<span class="co">#&gt;              [,1]         [,2]       [,3]</span>
<span class="co">#&gt; [1,]  0.497632305 -0.009076269 0.02899449</span>
<span class="co">#&gt; [2,] -0.009076269  0.474030013 0.01427275</span>
<span class="co">#&gt; [3,]  0.028994487  0.014272753 0.39957497</span></code></pre></div>
</div>
<div id="dimensional-phenotype-comparison-of-calc_covs-and-limmbo2" class="section level2">
<h2 class="hasAnchor">
<a href="#dimensional-phenotype-comparison-of-calc_covs-and-limmbo2" class="anchor"></a>5-dimensional phenotype comparison of <code><a href="../reference/calc_covs.html">calc_covs()</a></code> and <code><a href="http://www.rdocumentation.org/packages/limmbo2/topics/limmbo2">limmbo2()</a></code>
</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pheno &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">500</span>), <span class="dt">nrow =</span> <span class="dv">100</span>)
<span class="kw">system.time</span>(<span class="kw"><a href="../reference/calc_covs.html">calc_covs</a></span>(pheno, kinship))
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   0.146   0.008   0.155</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/limmbo2/topics/limmbo2">limmbo2</a></span>(<span class="dt">kinship =</span> kinship, <span class="dt">pheno =</span> pheno, <span class="dt">seed =</span> <span class="dv">1</span>))
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   0.255   0.045  10.517</span></code></pre></div>
</div>
<div id="increase-sample-size-to-500" class="section level2">
<h2 class="hasAnchor">
<a href="#increase-sample-size-to-500" class="anchor"></a>Increase sample size to 500</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pheno &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">2500</span>), <span class="dt">nrow =</span> <span class="dv">500</span>)
kinship &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="dv">500</span>)
<span class="kw">system.time</span>(<span class="kw"><a href="../reference/calc_covs.html">calc_covs</a></span>(pheno, kinship) -&gt;<span class="st"> </span>cc_out)
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   0.604   0.020   0.624</span>
cc_out
<span class="co">#&gt; $Vg</span>
<span class="co">#&gt;              [,1]         [,2]        [,3]        [,4]         [,5]</span>
<span class="co">#&gt; [1,]  0.510803808 -0.005144347  0.01128946 -0.01487633 -0.004673816</span>
<span class="co">#&gt; [2,] -0.005144347  0.525898264 -0.02962588 -0.01575937 -0.008577386</span>
<span class="co">#&gt; [3,]  0.011289457 -0.029625881  0.51353006  0.01275990 -0.024696491</span>
<span class="co">#&gt; [4,] -0.014876330 -0.015759375  0.01275990  0.51113509  0.013973250</span>
<span class="co">#&gt; [5,] -0.004673816 -0.008577386 -0.02469649  0.01397325  0.515487854</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Ve</span>
<span class="co">#&gt;              [,1]         [,2]        [,3]        [,4]         [,5]</span>
<span class="co">#&gt; [1,]  0.510803808 -0.005144347  0.01128946 -0.01487633 -0.004673816</span>
<span class="co">#&gt; [2,] -0.005144347  0.525898264 -0.02962588 -0.01575937 -0.008577386</span>
<span class="co">#&gt; [3,]  0.011289457 -0.029625881  0.51353006  0.01275990 -0.024696491</span>
<span class="co">#&gt; [4,] -0.014876330 -0.015759375  0.01275990  0.51113509  0.013973250</span>
<span class="co">#&gt; [5,] -0.004673816 -0.008577386 -0.02469649  0.01397325  0.515487854</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/limmbo2/topics/limmbo2">limmbo2</a></span>(<span class="dt">kinship =</span> kinship, <span class="dt">pheno =</span> pheno, <span class="dt">seed =</span> <span class="dv">1</span>) -&gt;<span class="st"> </span>li_out)
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   1.072   0.423   7.958</span>
li_out
<span class="co">#&gt; $Vg</span>
<span class="co">#&gt;              [,1]         [,2]        [,3]        [,4]         [,5]</span>
<span class="co">#&gt; [1,]  0.510588201 -0.005878301  0.01155754 -0.01431681 -0.003998505</span>
<span class="co">#&gt; [2,] -0.005878301  0.525550771 -0.02983613 -0.01622092 -0.009185075</span>
<span class="co">#&gt; [3,]  0.011557536 -0.029836130  0.51257722  0.01292646 -0.024395065</span>
<span class="co">#&gt; [4,] -0.014316809 -0.016220918  0.01292646  0.51044617  0.014385305</span>
<span class="co">#&gt; [5,] -0.003998505 -0.009185075 -0.02439506  0.01438531  0.515010638</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Ve</span>
<span class="co">#&gt;              [,1]         [,2]        [,3]        [,4]         [,5]</span>
<span class="co">#&gt; [1,]  0.510588201 -0.005878301  0.01155754 -0.01431681 -0.003998505</span>
<span class="co">#&gt; [2,] -0.005878301  0.525550771 -0.02983613 -0.01622092 -0.009185075</span>
<span class="co">#&gt; [3,]  0.011557536 -0.029836130  0.51257722  0.01292646 -0.024395065</span>
<span class="co">#&gt; [4,] -0.014316809 -0.016220918  0.01292646  0.51044617  0.014385305</span>
<span class="co">#&gt; [5,] -0.003998505 -0.009185075 -0.02439506  0.01438531  0.515010638</span></code></pre></div>
</div>
<div id="phenotypes" class="section level2">
<h2 class="hasAnchor">
<a href="#phenotypes" class="anchor"></a>15 phenotypes</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pheno &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">7500</span>), <span class="dt">nrow =</span> <span class="dv">500</span>)
<span class="kw">system.time</span>(<span class="kw"><a href="../reference/calc_covs.html">calc_covs</a></span>(pheno, kinship) -&gt;<span class="st"> </span>cc_out)
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   0.859   0.025   0.884</span>
cc_out
<span class="co">#&gt; $Vg</span>
<span class="co">#&gt;               [,1]         [,2]          [,3]          [,4]         [,5]</span>
<span class="co">#&gt;  [1,]  0.505401939  0.054242542  0.0186987231  0.0258511099 -0.019227119</span>
<span class="co">#&gt;  [2,]  0.054242542  0.443287480  0.0289402794 -0.0383921361  0.028104299</span>
<span class="co">#&gt;  [3,]  0.018698723  0.028940279  0.4893225141 -0.0007692246  0.019251615</span>
<span class="co">#&gt;  [4,]  0.025851110 -0.038392136 -0.0007692246  0.4960299014  0.012819360</span>
<span class="co">#&gt;  [5,] -0.019227119  0.028104299  0.0192516147  0.0128193601  0.544811883</span>
<span class="co">#&gt;  [6,] -0.006992642 -0.024791015  0.0088378142  0.0128334460  0.013963075</span>
<span class="co">#&gt;  [7,]  0.014531793  0.028334335 -0.0010545259 -0.0027170460 -0.003576036</span>
<span class="co">#&gt;  [8,]  0.015635351  0.012081771  0.0090808970  0.0055117684  0.040584373</span>
<span class="co">#&gt;  [9,]  0.029920845  0.001023528 -0.0171923914 -0.0394508382  0.007584183</span>
<span class="co">#&gt; [10,]  0.016515313  0.027329852  0.0050177519 -0.0168588072 -0.019247046</span>
<span class="co">#&gt; [11,] -0.015703545 -0.005794893  0.0335157852  0.0392806071 -0.016355352</span>
<span class="co">#&gt; [12,]  0.018435387  0.054941438  0.0121470156 -0.0129968223  0.043558960</span>
<span class="co">#&gt; [13,] -0.017174703 -0.015927424 -0.0102790485 -0.0439318464 -0.018562199</span>
<span class="co">#&gt; [14,]  0.042563280  0.035606908 -0.0103105127  0.0064091361  0.060292709</span>
<span class="co">#&gt; [15,]  0.003541374  0.002619638 -0.0282966944 -0.0290986874 -0.017892642</span>
<span class="co">#&gt;               [,6]         [,7]         [,8]         [,9]        [,10]</span>
<span class="co">#&gt;  [1,] -0.006992642  0.014531793  0.015635351  0.029920845  0.016515313</span>
<span class="co">#&gt;  [2,] -0.024791015  0.028334335  0.012081771  0.001023528  0.027329852</span>
<span class="co">#&gt;  [3,]  0.008837814 -0.001054526  0.009080897 -0.017192391  0.005017752</span>
<span class="co">#&gt;  [4,]  0.012833446 -0.002717046  0.005511768 -0.039450838 -0.016858807</span>
<span class="co">#&gt;  [5,]  0.013963075 -0.003576036  0.040584373  0.007584183 -0.019247046</span>
<span class="co">#&gt;  [6,]  0.468019184 -0.019775518  0.029989053 -0.025541769 -0.008931367</span>
<span class="co">#&gt;  [7,] -0.019775518  0.528001499 -0.013970887 -0.025315260  0.020575912</span>
<span class="co">#&gt;  [8,]  0.029989053 -0.013970887  0.549726196 -0.007876371  0.012970422</span>
<span class="co">#&gt;  [9,] -0.025541769 -0.025315260 -0.007876371  0.475597742  0.013226396</span>
<span class="co">#&gt; [10,] -0.008931367  0.020575912  0.012970422  0.013226396  0.483008334</span>
<span class="co">#&gt; [11,]  0.023867999 -0.007908952 -0.018964496  0.001410142 -0.010198473</span>
<span class="co">#&gt; [12,] -0.012881357  0.005359328 -0.013323560  0.012439463 -0.032972666</span>
<span class="co">#&gt; [13,] -0.032547855 -0.015203281 -0.016904239  0.015660984  0.017568319</span>
<span class="co">#&gt; [14,]  0.007307873  0.004025052 -0.052951628 -0.012864813 -0.004393686</span>
<span class="co">#&gt; [15,]  0.031733724  0.003336759 -0.001545653  0.013891977  0.018033051</span>
<span class="co">#&gt;              [,11]        [,12]        [,13]        [,14]        [,15]</span>
<span class="co">#&gt;  [1,] -0.015703545  0.018435387 -0.017174703  0.042563280  0.003541374</span>
<span class="co">#&gt;  [2,] -0.005794893  0.054941438 -0.015927424  0.035606908  0.002619638</span>
<span class="co">#&gt;  [3,]  0.033515785  0.012147016 -0.010279049 -0.010310513 -0.028296694</span>
<span class="co">#&gt;  [4,]  0.039280607 -0.012996822 -0.043931846  0.006409136 -0.029098687</span>
<span class="co">#&gt;  [5,] -0.016355352  0.043558960 -0.018562199  0.060292709 -0.017892642</span>
<span class="co">#&gt;  [6,]  0.023867999 -0.012881357 -0.032547855  0.007307873  0.031733724</span>
<span class="co">#&gt;  [7,] -0.007908952  0.005359328 -0.015203281  0.004025052  0.003336759</span>
<span class="co">#&gt;  [8,] -0.018964496 -0.013323560 -0.016904239 -0.052951628 -0.001545653</span>
<span class="co">#&gt;  [9,]  0.001410142  0.012439463  0.015660984 -0.012864813  0.013891977</span>
<span class="co">#&gt; [10,] -0.010198473 -0.032972666  0.017568319 -0.004393686  0.018033051</span>
<span class="co">#&gt; [11,]  0.522148017  0.017207864 -0.008616771  0.006540495 -0.025622543</span>
<span class="co">#&gt; [12,]  0.017207864  0.500483352 -0.011145364 -0.003314208 -0.010704281</span>
<span class="co">#&gt; [13,] -0.008616771 -0.011145364  0.456514185  0.006739120 -0.011611107</span>
<span class="co">#&gt; [14,]  0.006540495 -0.003314208  0.006739120  0.541246118  0.001797156</span>
<span class="co">#&gt; [15,] -0.025622543 -0.010704281 -0.011611107  0.001797156  0.466404228</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Ve</span>
<span class="co">#&gt;               [,1]         [,2]          [,3]          [,4]         [,5]</span>
<span class="co">#&gt;  [1,]  0.505401939  0.054242542  0.0186987231  0.0258511099 -0.019227119</span>
<span class="co">#&gt;  [2,]  0.054242542  0.443287480  0.0289402794 -0.0383921361  0.028104299</span>
<span class="co">#&gt;  [3,]  0.018698723  0.028940279  0.4893225141 -0.0007692246  0.019251615</span>
<span class="co">#&gt;  [4,]  0.025851110 -0.038392136 -0.0007692246  0.4960299014  0.012819360</span>
<span class="co">#&gt;  [5,] -0.019227119  0.028104299  0.0192516147  0.0128193601  0.544811883</span>
<span class="co">#&gt;  [6,] -0.006992642 -0.024791015  0.0088378142  0.0128334460  0.013963075</span>
<span class="co">#&gt;  [7,]  0.014531793  0.028334335 -0.0010545259 -0.0027170460 -0.003576036</span>
<span class="co">#&gt;  [8,]  0.015635351  0.012081771  0.0090808970  0.0055117684  0.040584373</span>
<span class="co">#&gt;  [9,]  0.029920845  0.001023528 -0.0171923914 -0.0394508382  0.007584183</span>
<span class="co">#&gt; [10,]  0.016515313  0.027329852  0.0050177519 -0.0168588072 -0.019247046</span>
<span class="co">#&gt; [11,] -0.015703545 -0.005794893  0.0335157852  0.0392806071 -0.016355352</span>
<span class="co">#&gt; [12,]  0.018435387  0.054941438  0.0121470156 -0.0129968223  0.043558960</span>
<span class="co">#&gt; [13,] -0.017174703 -0.015927424 -0.0102790485 -0.0439318464 -0.018562199</span>
<span class="co">#&gt; [14,]  0.042563280  0.035606908 -0.0103105127  0.0064091361  0.060292709</span>
<span class="co">#&gt; [15,]  0.003541374  0.002619638 -0.0282966944 -0.0290986874 -0.017892642</span>
<span class="co">#&gt;               [,6]         [,7]         [,8]         [,9]        [,10]</span>
<span class="co">#&gt;  [1,] -0.006992642  0.014531793  0.015635351  0.029920845  0.016515313</span>
<span class="co">#&gt;  [2,] -0.024791015  0.028334335  0.012081771  0.001023528  0.027329852</span>
<span class="co">#&gt;  [3,]  0.008837814 -0.001054526  0.009080897 -0.017192391  0.005017752</span>
<span class="co">#&gt;  [4,]  0.012833446 -0.002717046  0.005511768 -0.039450838 -0.016858807</span>
<span class="co">#&gt;  [5,]  0.013963075 -0.003576036  0.040584373  0.007584183 -0.019247046</span>
<span class="co">#&gt;  [6,]  0.468019184 -0.019775518  0.029989053 -0.025541769 -0.008931367</span>
<span class="co">#&gt;  [7,] -0.019775518  0.528001499 -0.013970887 -0.025315260  0.020575912</span>
<span class="co">#&gt;  [8,]  0.029989053 -0.013970887  0.549726196 -0.007876371  0.012970422</span>
<span class="co">#&gt;  [9,] -0.025541769 -0.025315260 -0.007876371  0.475597742  0.013226396</span>
<span class="co">#&gt; [10,] -0.008931367  0.020575912  0.012970422  0.013226396  0.483008334</span>
<span class="co">#&gt; [11,]  0.023867999 -0.007908952 -0.018964496  0.001410142 -0.010198473</span>
<span class="co">#&gt; [12,] -0.012881357  0.005359328 -0.013323560  0.012439463 -0.032972666</span>
<span class="co">#&gt; [13,] -0.032547855 -0.015203281 -0.016904239  0.015660984  0.017568319</span>
<span class="co">#&gt; [14,]  0.007307873  0.004025052 -0.052951628 -0.012864813 -0.004393686</span>
<span class="co">#&gt; [15,]  0.031733724  0.003336759 -0.001545653  0.013891977  0.018033051</span>
<span class="co">#&gt;              [,11]        [,12]        [,13]        [,14]        [,15]</span>
<span class="co">#&gt;  [1,] -0.015703545  0.018435387 -0.017174703  0.042563280  0.003541374</span>
<span class="co">#&gt;  [2,] -0.005794893  0.054941438 -0.015927424  0.035606908  0.002619638</span>
<span class="co">#&gt;  [3,]  0.033515785  0.012147016 -0.010279049 -0.010310513 -0.028296694</span>
<span class="co">#&gt;  [4,]  0.039280607 -0.012996822 -0.043931846  0.006409136 -0.029098687</span>
<span class="co">#&gt;  [5,] -0.016355352  0.043558960 -0.018562199  0.060292709 -0.017892642</span>
<span class="co">#&gt;  [6,]  0.023867999 -0.012881357 -0.032547855  0.007307873  0.031733724</span>
<span class="co">#&gt;  [7,] -0.007908952  0.005359328 -0.015203281  0.004025052  0.003336759</span>
<span class="co">#&gt;  [8,] -0.018964496 -0.013323560 -0.016904239 -0.052951628 -0.001545653</span>
<span class="co">#&gt;  [9,]  0.001410142  0.012439463  0.015660984 -0.012864813  0.013891977</span>
<span class="co">#&gt; [10,] -0.010198473 -0.032972666  0.017568319 -0.004393686  0.018033051</span>
<span class="co">#&gt; [11,]  0.522148017  0.017207864 -0.008616771  0.006540495 -0.025622543</span>
<span class="co">#&gt; [12,]  0.017207864  0.500483352 -0.011145364 -0.003314208 -0.010704281</span>
<span class="co">#&gt; [13,] -0.008616771 -0.011145364  0.456514185  0.006739120 -0.011611107</span>
<span class="co">#&gt; [14,]  0.006540495 -0.003314208  0.006739120  0.541246118  0.001797156</span>
<span class="co">#&gt; [15,] -0.025622543 -0.010704281 -0.011611107  0.001797156  0.466404228</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/limmbo2/topics/limmbo2">limmbo2</a></span>(<span class="dt">kinship =</span> kinship, <span class="dt">pheno =</span> pheno, <span class="dt">S =</span> <span class="dv">3</span>, <span class="dt">seed =</span> <span class="dv">1</span>) -&gt;<span class="st"> </span>li_out)
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   4.030   1.323  20.125</span>
li_out
<span class="co">#&gt; $Vg</span>
<span class="co">#&gt;               [,1]         [,2]          [,3]          [,4]         [,5]</span>
<span class="co">#&gt;  [1,]  0.504894477  0.054513907  0.0186272904  0.0247305142 -0.018432865</span>
<span class="co">#&gt;  [2,]  0.054513907  0.442700522  0.0288536839 -0.0391095129  0.028609464</span>
<span class="co">#&gt;  [3,]  0.018627290  0.028853684  0.4883459976 -0.0007059681  0.019165738</span>
<span class="co">#&gt;  [4,]  0.024730514 -0.039109513 -0.0007059681  0.4972097126  0.011251926</span>
<span class="co">#&gt;  [5,] -0.018432865  0.028609464  0.0191657376  0.0112519257  0.544799615</span>
<span class="co">#&gt;  [6,] -0.007876688 -0.025415259  0.0088705067  0.0146470144  0.012630429</span>
<span class="co">#&gt;  [7,]  0.015436825  0.028978972 -0.0011064598 -0.0046301851 -0.002211382</span>
<span class="co">#&gt;  [8,]  0.014892547  0.011520700  0.0091020246  0.0069501036  0.039470044</span>
<span class="co">#&gt;  [9,]  0.030781261  0.001720631 -0.0172081222 -0.0412613841  0.008909098</span>
<span class="co">#&gt; [10,]  0.016900394  0.027587546  0.0049822333 -0.0176851468 -0.018593913</span>
<span class="co">#&gt; [11,] -0.014838771 -0.005155570  0.0333947591  0.0374946411 -0.015117662</span>
<span class="co">#&gt; [12,]  0.018372635  0.054803937  0.0121216653 -0.0129230583  0.043431483</span>
<span class="co">#&gt; [13,] -0.017167602 -0.015915578 -0.0102544531 -0.0437703854 -0.018566195</span>
<span class="co">#&gt; [14,]  0.042122601  0.035266827 -0.0102676696  0.0071031389  0.059658497</span>
<span class="co">#&gt; [15,]  0.002283943  0.001670906 -0.0281623744 -0.0264760419 -0.019662432</span>
<span class="co">#&gt;               [,6]         [,7]          [,8]         [,9]        [,10]</span>
<span class="co">#&gt;  [1,] -0.007876688  0.015436825  0.0148925466  0.030781261  0.016900394</span>
<span class="co">#&gt;  [2,] -0.025415259  0.028978972  0.0115207000  0.001720631  0.027587546</span>
<span class="co">#&gt;  [3,]  0.008870507 -0.001106460  0.0091020246 -0.017208122  0.004982233</span>
<span class="co">#&gt;  [4,]  0.014647014 -0.004630185  0.0069501036 -0.041261384 -0.017685147</span>
<span class="co">#&gt;  [5,]  0.012630429 -0.002211382  0.0394700436  0.008909098 -0.018593913</span>
<span class="co">#&gt;  [6,]  0.468655933 -0.021355654  0.0311506925 -0.027091109 -0.009642345</span>
<span class="co">#&gt;  [7,] -0.021355654  0.528627546 -0.0152188207 -0.023586500  0.021291729</span>
<span class="co">#&gt;  [8,]  0.031150693 -0.015218821  0.5495931098 -0.009123402  0.012366496</span>
<span class="co">#&gt;  [9,] -0.027091109 -0.023586500 -0.0091234017  0.476299838  0.013949940</span>
<span class="co">#&gt; [10,] -0.009642345  0.021291729  0.0123664965  0.013949940  0.482378293</span>
<span class="co">#&gt; [11,]  0.022377894 -0.006392847 -0.0200562454  0.002889238 -0.009501660</span>
<span class="co">#&gt; [12,] -0.012815001  0.005307702 -0.0132643590  0.012372699 -0.032918009</span>
<span class="co">#&gt; [13,] -0.032422021 -0.015225814 -0.0168244126  0.015570509  0.017503870</span>
<span class="co">#&gt; [14,]  0.007890896  0.003391847 -0.0523631014 -0.013453611 -0.004664874</span>
<span class="co">#&gt; [15,]  0.033829140  0.001073874  0.0001624263  0.011631057  0.016978321</span>
<span class="co">#&gt;              [,11]        [,12]        [,13]        [,14]         [,15]</span>
<span class="co">#&gt;  [1,] -0.014838771  0.018372635 -0.017167602  0.042122601  0.0022839426</span>
<span class="co">#&gt;  [2,] -0.005155570  0.054803937 -0.015915578  0.035266827  0.0016709062</span>
<span class="co">#&gt;  [3,]  0.033394759  0.012121665 -0.010254453 -0.010267670 -0.0281623744</span>
<span class="co">#&gt;  [4,]  0.037494641 -0.012923058 -0.043770385  0.007103139 -0.0264760419</span>
<span class="co">#&gt;  [5,] -0.015117662  0.043431483 -0.018566195  0.059658497 -0.0196624318</span>
<span class="co">#&gt;  [6,]  0.022377894 -0.012815001 -0.032422021  0.007890896  0.0338291405</span>
<span class="co">#&gt;  [7,] -0.006392847  0.005307702 -0.015225814  0.003391847  0.0010738742</span>
<span class="co">#&gt;  [8,] -0.020056245 -0.013264359 -0.016824413 -0.052363101  0.0001624263</span>
<span class="co">#&gt;  [9,]  0.002889238  0.012372699  0.015570509 -0.013453611  0.0116310574</span>
<span class="co">#&gt; [10,] -0.009501660 -0.032918009  0.017503870 -0.004664874  0.0169783213</span>
<span class="co">#&gt; [11,]  0.522452556  0.017135248 -0.008647799  0.005973088 -0.0275655135</span>
<span class="co">#&gt; [12,]  0.017135248  0.499490106 -0.011119428 -0.003292101 -0.0106278001</span>
<span class="co">#&gt; [13,] -0.008647799 -0.011119428  0.455596259  0.006744873 -0.0115104094</span>
<span class="co">#&gt; [14,]  0.005973088 -0.003292101  0.006744873  0.540369942  0.0026255723</span>
<span class="co">#&gt; [15,] -0.027565514 -0.010627800 -0.011510409  0.002625572  0.4684938232</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Ve</span>
<span class="co">#&gt;               [,1]         [,2]          [,3]          [,4]         [,5]</span>
<span class="co">#&gt;  [1,]  0.504894477  0.054513907  0.0186272904  0.0247305142 -0.018432865</span>
<span class="co">#&gt;  [2,]  0.054513907  0.442700522  0.0288536839 -0.0391095129  0.028609464</span>
<span class="co">#&gt;  [3,]  0.018627290  0.028853684  0.4883459976 -0.0007059681  0.019165738</span>
<span class="co">#&gt;  [4,]  0.024730514 -0.039109513 -0.0007059681  0.4972097126  0.011251926</span>
<span class="co">#&gt;  [5,] -0.018432865  0.028609464  0.0191657376  0.0112519257  0.544799615</span>
<span class="co">#&gt;  [6,] -0.007876688 -0.025415259  0.0088705067  0.0146470144  0.012630429</span>
<span class="co">#&gt;  [7,]  0.015436825  0.028978972 -0.0011064598 -0.0046301851 -0.002211382</span>
<span class="co">#&gt;  [8,]  0.014892547  0.011520700  0.0091020246  0.0069501036  0.039470044</span>
<span class="co">#&gt;  [9,]  0.030781261  0.001720631 -0.0172081222 -0.0412613841  0.008909098</span>
<span class="co">#&gt; [10,]  0.016900394  0.027587546  0.0049822333 -0.0176851468 -0.018593913</span>
<span class="co">#&gt; [11,] -0.014838771 -0.005155570  0.0333947591  0.0374946411 -0.015117662</span>
<span class="co">#&gt; [12,]  0.018372635  0.054803937  0.0121216653 -0.0129230583  0.043431483</span>
<span class="co">#&gt; [13,] -0.017167602 -0.015915578 -0.0102544531 -0.0437703854 -0.018566195</span>
<span class="co">#&gt; [14,]  0.042122601  0.035266827 -0.0102676696  0.0071031389  0.059658497</span>
<span class="co">#&gt; [15,]  0.002283943  0.001670906 -0.0281623744 -0.0264760419 -0.019662432</span>
<span class="co">#&gt;               [,6]         [,7]          [,8]         [,9]        [,10]</span>
<span class="co">#&gt;  [1,] -0.007876688  0.015436825  0.0148925466  0.030781261  0.016900394</span>
<span class="co">#&gt;  [2,] -0.025415259  0.028978972  0.0115207000  0.001720631  0.027587546</span>
<span class="co">#&gt;  [3,]  0.008870507 -0.001106460  0.0091020246 -0.017208122  0.004982233</span>
<span class="co">#&gt;  [4,]  0.014647014 -0.004630185  0.0069501036 -0.041261384 -0.017685147</span>
<span class="co">#&gt;  [5,]  0.012630429 -0.002211382  0.0394700436  0.008909098 -0.018593913</span>
<span class="co">#&gt;  [6,]  0.468655933 -0.021355654  0.0311506925 -0.027091109 -0.009642345</span>
<span class="co">#&gt;  [7,] -0.021355654  0.528627546 -0.0152188207 -0.023586500  0.021291729</span>
<span class="co">#&gt;  [8,]  0.031150693 -0.015218821  0.5495931098 -0.009123402  0.012366496</span>
<span class="co">#&gt;  [9,] -0.027091109 -0.023586500 -0.0091234017  0.476299838  0.013949940</span>
<span class="co">#&gt; [10,] -0.009642345  0.021291729  0.0123664965  0.013949940  0.482378293</span>
<span class="co">#&gt; [11,]  0.022377894 -0.006392847 -0.0200562454  0.002889238 -0.009501660</span>
<span class="co">#&gt; [12,] -0.012815001  0.005307702 -0.0132643590  0.012372699 -0.032918009</span>
<span class="co">#&gt; [13,] -0.032422021 -0.015225814 -0.0168244126  0.015570509  0.017503870</span>
<span class="co">#&gt; [14,]  0.007890896  0.003391847 -0.0523631014 -0.013453611 -0.004664874</span>
<span class="co">#&gt; [15,]  0.033829140  0.001073874  0.0001624263  0.011631057  0.016978321</span>
<span class="co">#&gt;              [,11]        [,12]        [,13]        [,14]         [,15]</span>
<span class="co">#&gt;  [1,] -0.014838771  0.018372635 -0.017167602  0.042122601  0.0022839426</span>
<span class="co">#&gt;  [2,] -0.005155570  0.054803937 -0.015915578  0.035266827  0.0016709062</span>
<span class="co">#&gt;  [3,]  0.033394759  0.012121665 -0.010254453 -0.010267670 -0.0281623744</span>
<span class="co">#&gt;  [4,]  0.037494641 -0.012923058 -0.043770385  0.007103139 -0.0264760419</span>
<span class="co">#&gt;  [5,] -0.015117662  0.043431483 -0.018566195  0.059658497 -0.0196624318</span>
<span class="co">#&gt;  [6,]  0.022377894 -0.012815001 -0.032422021  0.007890896  0.0338291405</span>
<span class="co">#&gt;  [7,] -0.006392847  0.005307702 -0.015225814  0.003391847  0.0010738742</span>
<span class="co">#&gt;  [8,] -0.020056245 -0.013264359 -0.016824413 -0.052363101  0.0001624263</span>
<span class="co">#&gt;  [9,]  0.002889238  0.012372699  0.015570509 -0.013453611  0.0116310574</span>
<span class="co">#&gt; [10,] -0.009501660 -0.032918009  0.017503870 -0.004664874  0.0169783213</span>
<span class="co">#&gt; [11,]  0.522452556  0.017135248 -0.008647799  0.005973088 -0.0275655135</span>
<span class="co">#&gt; [12,]  0.017135248  0.499490106 -0.011119428 -0.003292101 -0.0106278001</span>
<span class="co">#&gt; [13,] -0.008647799 -0.011119428  0.455596259  0.006744873 -0.0115104094</span>
<span class="co">#&gt; [14,]  0.005973088 -0.003292101  0.006744873  0.540369942  0.0026255723</span>
<span class="co">#&gt; [15,] -0.027565514 -0.010627800 -0.011510409  0.002625572  0.4684938232</span></code></pre></div>
</div>
<div id="use-nontrivial-kinship-with-trivariate-phenotype" class="section level2">
<h2 class="hasAnchor">
<a href="#use-nontrivial-kinship-with-trivariate-phenotype" class="anchor"></a>Use nontrivial kinship with trivariate phenotype</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="dv">500</span>
A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(n <span class="op">^</span><span class="st"> </span><span class="dv">2</span>), <span class="dt">ncol =</span> n) 
kinship &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">t</span>(A) <span class="op">%*%</span><span class="st"> </span>A, <span class="dv">6</span>)
pheno &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">1500</span>), <span class="dt">nrow =</span> <span class="dv">500</span>)

<span class="kw">system.time</span>(<span class="kw"><a href="../reference/calc_covs.html">calc_covs</a></span>(pheno, kinship) -&gt;<span class="st"> </span>cc_out)
<span class="co">#&gt;     user   system  elapsed </span>
<span class="co">#&gt; 2440.164   11.012 2455.882</span>
cc_out
<span class="co">#&gt; $Vg</span>
<span class="co">#&gt;              [,1]         [,2]         [,3]</span>
<span class="co">#&gt; [1,] 0.0012789534 0.0003585426 0.0005834074</span>
<span class="co">#&gt; [2,] 0.0003585426 0.0018738131 0.0002792752</span>
<span class="co">#&gt; [3,] 0.0005834074 0.0002792752 0.0002763931</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Ve</span>
<span class="co">#&gt;             [,1]        [,2]        [,3]</span>
<span class="co">#&gt; [1,]  0.91342421 -0.00457590 -0.02808836</span>
<span class="co">#&gt; [2,] -0.00457590  0.95036698 -0.04682153</span>
<span class="co">#&gt; [3,] -0.02808836 -0.04682153  0.84965502</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/limmbo2/topics/limmbo2">limmbo2</a></span>(<span class="dt">kinship =</span> kinship, <span class="dt">pheno =</span> pheno, <span class="dt">S =</span> <span class="dv">3</span>, <span class="dt">seed =</span> <span class="dv">1</span>) -&gt;<span class="st"> </span>li_out)
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   0.642   0.076   5.404</span>
li_out
<span class="co">#&gt; $Vg</span>
<span class="co">#&gt;              [,1]         [,2]         [,3]</span>
<span class="co">#&gt; [1,] 2.642006e-04 0.0002649933 6.504549e-05</span>
<span class="co">#&gt; [2,] 2.649933e-04 0.0011055614 2.253002e-04</span>
<span class="co">#&gt; [3,] 6.504549e-05 0.0002253002 2.429977e-04</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Ve</span>
<span class="co">#&gt;              [,1]        [,2]         [,3]</span>
<span class="co">#&gt; [1,]  0.957934100 -0.00322888 -0.007420916</span>
<span class="co">#&gt; [2,] -0.003228880  0.97768390 -0.046358337</span>
<span class="co">#&gt; [3,] -0.007420916 -0.04635834  0.854456149</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#background">Background</a></li>
      <li><a href="#goals">Goals</a></li>
      <li><a href="#first-gemma2-method">First, <code>gemma2</code> method:</a></li>
      <li><a href="#dimensional-phenotype-comparison-of-calc_covs-and-limmbo2">5-dimensional phenotype comparison of <code><a href="--/reference/calc_covs-html">calc_covs()</a></code> and <code><a href="http://www-rdocumentation-org/packages/limmbo2/topics/limmbo2">limmbo2()</a></code></a></li>
      <li><a href="#increase-sample-size-to-500">Increase sample size to 500</a></li>
      <li><a href="#phenotypes">15 phenotypes</a></li>
      <li><a href="#use-nontrivial-kinship-with-trivariate-phenotype">Use nontrivial kinship with trivariate phenotype</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Frederick Boehm.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
