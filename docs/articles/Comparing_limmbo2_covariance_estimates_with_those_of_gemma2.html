<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Comparing covariance estimates between <code>limmbo2</code> and <code>gemma2</code> • qtl2pleio</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Comparing covariance estimates between &lt;code&gt;limmbo2&lt;/code&gt; and &lt;code&gt;gemma2&lt;/code&gt;">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">qtl2pleio</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Comparing_limmbo2_covariance_estimates_with_those_of_gemma2.html">Comparing covariance estimates between `limmbo2` and `gemma2`</a>
    </li>
    <li>
      <a href="../articles/testing-close-linkage-vs-pleiotropy.html">Testing close linkage v. pleiotropy</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/fboehm/qtl2pleio">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Comparing covariance estimates between <code>limmbo2</code> and <code>gemma2</code>
</h1>
                        <h4 class="author">Frederick Boehm</h4>
            
            <h4 class="date">2018-04-10</h4>
      
      <small>Source: <a href="https://github.com/fboehm/qtl2pleio/blob/master/vignettes/Comparing_limmbo2_covariance_estimates_with_those_of_gemma2.Rmd"><code>vignettes/Comparing_limmbo2_covariance_estimates_with_those_of_gemma2.Rmd</code></a></small>
      <p class="hidden name"><code>Comparing_limmbo2_covariance_estimates_with_those_of_gemma2.Rmd</code></p>

    </div>

    
    
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<p><a href="https://github.com/fboehm/gemma2"><code>gemma2</code></a> is an R implementation of the C++ code for EM-based estimation of Vg and Ve. <code>limmbo2</code> is a R wrapper to the <a href="https://github.com/HannahVMeyer/limmbo"><code>limmbo</code></a> python module.</p>
</div>
<div id="goals" class="section level2">
<h2 class="hasAnchor">
<a href="#goals" class="anchor"></a>Goals</h2>
<p>I want to see how similar the variance component estimates are for the two methods. Recall that it’s the function <code><a href="../reference/calc_covs.html">qtl2pleio::calc_covs</a></code> that I want to use to get the estimates based on gemma2’s EM algorithm. limmbo2() in the limmbo2 R package will provide both Vg and Ve.</p>
</div>
<div id="first-gemma2-method" class="section level2">
<h2 class="hasAnchor">
<a href="#first-gemma2-method" class="anchor"></a>First, <code>gemma2</code> method:</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(qtl2pleio)
pheno &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">300</span>), <span class="dt">nrow =</span> <span class="dv">100</span>)
kinship &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="dv">100</span>)
<span class="kw"><a href="../reference/calc_covs.html">calc_covs</a></span>(pheno, kinship)
<span class="co">#&gt; $Vg</span>
<span class="co">#&gt;             [,1]         [,2]         [,3]</span>
<span class="co">#&gt; [1,]  0.48778559 -0.070752878  0.032806120</span>
<span class="co">#&gt; [2,] -0.07075288  0.445529142 -0.005842817</span>
<span class="co">#&gt; [3,]  0.03280612 -0.005842817  0.556493767</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Ve</span>
<span class="co">#&gt;             [,1]         [,2]         [,3]</span>
<span class="co">#&gt; [1,]  0.48778559 -0.070752878  0.032806120</span>
<span class="co">#&gt; [2,] -0.07075288  0.445529142 -0.005842817</span>
<span class="co">#&gt; [3,]  0.03280612 -0.005842817  0.556493767</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(limmbo2)
<span class="kw"><a href="http://www.rdocumentation.org/packages/limmbo2/topics/limmbo2">limmbo2</a></span>(<span class="dt">kinship =</span> kinship, <span class="dt">pheno =</span> pheno, <span class="dt">seed =</span> <span class="dv">1</span>)
<span class="co">#&gt; $Vg</span>
<span class="co">#&gt;             [,1]         [,2]         [,3]</span>
<span class="co">#&gt; [1,]  0.48499463 -0.068554363  0.032955965</span>
<span class="co">#&gt; [2,] -0.06855436  0.442126886 -0.005445922</span>
<span class="co">#&gt; [3,]  0.03295596 -0.005445922  0.551009458</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Ve</span>
<span class="co">#&gt;             [,1]         [,2]         [,3]</span>
<span class="co">#&gt; [1,]  0.48499463 -0.068554363  0.032955965</span>
<span class="co">#&gt; [2,] -0.06855436  0.442126886 -0.005445922</span>
<span class="co">#&gt; [3,]  0.03295596 -0.005445922  0.551009458</span></code></pre></div>
</div>
<div id="dimensional-phenotype-comparison-of-calc_covs-and-limmbo2" class="section level2">
<h2 class="hasAnchor">
<a href="#dimensional-phenotype-comparison-of-calc_covs-and-limmbo2" class="anchor"></a>5-dimensional phenotype comparison of <code><a href="../reference/calc_covs.html">calc_covs()</a></code> and <code><a href="http://www.rdocumentation.org/packages/limmbo2/topics/limmbo2">limmbo2()</a></code>
</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pheno &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">500</span>), <span class="dt">nrow =</span> <span class="dv">100</span>)
<span class="kw">system.time</span>(<span class="kw"><a href="../reference/calc_covs.html">calc_covs</a></span>(pheno, kinship))
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   0.151   0.009   0.159</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/limmbo2/topics/limmbo2">limmbo2</a></span>(<span class="dt">kinship =</span> kinship, <span class="dt">pheno =</span> pheno, <span class="dt">seed =</span> <span class="dv">1</span>))
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   0.258   0.043   5.815</span></code></pre></div>
</div>
<div id="increase-sample-size-to-500" class="section level2">
<h2 class="hasAnchor">
<a href="#increase-sample-size-to-500" class="anchor"></a>Increase sample size to 500</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pheno &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">2500</span>), <span class="dt">nrow =</span> <span class="dv">500</span>)
kinship &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="dv">500</span>)
<span class="kw">system.time</span>(<span class="kw"><a href="../reference/calc_covs.html">calc_covs</a></span>(pheno, kinship) -&gt;<span class="st"> </span>cc_out)
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   0.579   0.015   0.594</span>
cc_out
<span class="co">#&gt; $Vg</span>
<span class="co">#&gt;              [,1]         [,2]         [,3]         [,4]         [,5]</span>
<span class="co">#&gt; [1,]  0.479937587  0.037672273 -0.007381742 -0.008832955  0.026847733</span>
<span class="co">#&gt; [2,]  0.037672273  0.520622482 -0.033141797  0.029660828  0.006612223</span>
<span class="co">#&gt; [3,] -0.007381742 -0.033141797  0.521339943 -0.005522972 -0.002173053</span>
<span class="co">#&gt; [4,] -0.008832955  0.029660828 -0.005522972  0.468294373 -0.029363386</span>
<span class="co">#&gt; [5,]  0.026847733  0.006612223 -0.002173053 -0.029363386  0.571493193</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Ve</span>
<span class="co">#&gt;              [,1]         [,2]         [,3]         [,4]         [,5]</span>
<span class="co">#&gt; [1,]  0.479937587  0.037672273 -0.007381742 -0.008832955  0.026847733</span>
<span class="co">#&gt; [2,]  0.037672273  0.520622482 -0.033141797  0.029660828  0.006612223</span>
<span class="co">#&gt; [3,] -0.007381742 -0.033141797  0.521339943 -0.005522972 -0.002173053</span>
<span class="co">#&gt; [4,] -0.008832955  0.029660828 -0.005522972  0.468294373 -0.029363386</span>
<span class="co">#&gt; [5,]  0.026847733  0.006612223 -0.002173053 -0.029363386  0.571493193</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/limmbo2/topics/limmbo2">limmbo2</a></span>(<span class="dt">kinship =</span> kinship, <span class="dt">pheno =</span> pheno, <span class="dt">seed =</span> <span class="dv">1</span>) -&gt;<span class="st"> </span>li_out)
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   1.078   0.384   6.681</span>
li_out
<span class="co">#&gt; $Vg</span>
<span class="co">#&gt;              [,1]         [,2]         [,3]         [,4]         [,5]</span>
<span class="co">#&gt; [1,]  0.479122270  0.037378502 -0.007407257 -0.008699600  0.026825027</span>
<span class="co">#&gt; [2,]  0.037378502  0.519945498 -0.032997044  0.029401474  0.006536692</span>
<span class="co">#&gt; [3,] -0.007407257 -0.032997044  0.520275149 -0.005548878 -0.002180265</span>
<span class="co">#&gt; [4,] -0.008699600  0.029401474 -0.005548878  0.467454411 -0.029265575</span>
<span class="co">#&gt; [5,]  0.026825027  0.006536692 -0.002180265 -0.029265575  0.570343977</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Ve</span>
<span class="co">#&gt;              [,1]         [,2]         [,3]         [,4]         [,5]</span>
<span class="co">#&gt; [1,]  0.479122270  0.037378502 -0.007407257 -0.008699600  0.026825027</span>
<span class="co">#&gt; [2,]  0.037378502  0.519945498 -0.032997044  0.029401474  0.006536692</span>
<span class="co">#&gt; [3,] -0.007407257 -0.032997044  0.520275149 -0.005548878 -0.002180265</span>
<span class="co">#&gt; [4,] -0.008699600  0.029401474 -0.005548878  0.467454411 -0.029265575</span>
<span class="co">#&gt; [5,]  0.026825027  0.006536692 -0.002180265 -0.029265575  0.570343977</span></code></pre></div>
</div>
<div id="phenotypes" class="section level2">
<h2 class="hasAnchor">
<a href="#phenotypes" class="anchor"></a>15 phenotypes</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pheno &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">7500</span>), <span class="dt">nrow =</span> <span class="dv">500</span>)
<span class="kw">system.time</span>(<span class="kw"><a href="../reference/calc_covs.html">calc_covs</a></span>(pheno, kinship) -&gt;<span class="st"> </span>cc_out)
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   0.824   0.017   0.842</span>
cc_out
<span class="co">#&gt; $Vg</span>
<span class="co">#&gt;               [,1]         [,2]         [,3]         [,4]          [,5]</span>
<span class="co">#&gt;  [1,]  0.484429640  0.018952656  0.019647735  0.007917787 -0.0096009074</span>
<span class="co">#&gt;  [2,]  0.018952656  0.463872708  0.027556066 -0.010638466  0.0208389737</span>
<span class="co">#&gt;  [3,]  0.019647735  0.027556066  0.506822952  0.012382968 -0.0317597472</span>
<span class="co">#&gt;  [4,]  0.007917787 -0.010638466  0.012382968  0.486349251 -0.0108736702</span>
<span class="co">#&gt;  [5,] -0.009600907  0.020838974 -0.031759747 -0.010873670  0.5334386743</span>
<span class="co">#&gt;  [6,] -0.015882618  0.034663481 -0.013153992 -0.030089512  0.0001259003</span>
<span class="co">#&gt;  [7,]  0.062978214  0.020998955 -0.019396503 -0.033260494 -0.0072338583</span>
<span class="co">#&gt;  [8,]  0.041432980  0.008755777 -0.008387393  0.005283669 -0.0095590894</span>
<span class="co">#&gt;  [9,] -0.012465587 -0.002310092  0.005330635 -0.019870939 -0.0385871828</span>
<span class="co">#&gt; [10,]  0.023799028  0.031413786  0.027704980  0.026396731 -0.0408076555</span>
<span class="co">#&gt; [11,] -0.029473039  0.008697755  0.033477375  0.030718926  0.0378360054</span>
<span class="co">#&gt; [12,] -0.034369574  0.015621285  0.020139906 -0.008479027  0.0148636515</span>
<span class="co">#&gt; [13,] -0.009187819  0.027498508  0.026509198 -0.008393771  0.0126639318</span>
<span class="co">#&gt; [14,] -0.007874167  0.019585120 -0.002049271 -0.005222803 -0.0051922696</span>
<span class="co">#&gt; [15,]  0.014245647  0.016953669  0.007235159 -0.015031420  0.0094868625</span>
<span class="co">#&gt;                [,6]          [,7]         [,8]          [,9]        [,10]</span>
<span class="co">#&gt;  [1,] -0.0158826182  0.0629782136  0.041432980 -0.0124655873  0.023799028</span>
<span class="co">#&gt;  [2,]  0.0346634814  0.0209989549  0.008755777 -0.0023100924  0.031413786</span>
<span class="co">#&gt;  [3,] -0.0131539921 -0.0193965029 -0.008387393  0.0053306351  0.027704980</span>
<span class="co">#&gt;  [4,] -0.0300895119 -0.0332604942  0.005283669 -0.0198709393  0.026396731</span>
<span class="co">#&gt;  [5,]  0.0001259003 -0.0072338583 -0.009559089 -0.0385871828 -0.040807655</span>
<span class="co">#&gt;  [6,]  0.4854852358  0.0456633103 -0.006091857 -0.0009842558  0.004435829</span>
<span class="co">#&gt;  [7,]  0.0456633103  0.5124943401  0.054639955  0.0051256057 -0.006494508</span>
<span class="co">#&gt;  [8,] -0.0060918569  0.0546399553  0.540650519 -0.0291287183  0.012575213</span>
<span class="co">#&gt;  [9,] -0.0009842558  0.0051256057 -0.029128718  0.4942695974 -0.008134746</span>
<span class="co">#&gt; [10,]  0.0044358287 -0.0064945081  0.012575213 -0.0081347456  0.526579475</span>
<span class="co">#&gt; [11,] -0.0060948762  0.0172788543 -0.012440456  0.0171724624 -0.012254129</span>
<span class="co">#&gt; [12,]  0.0129599085 -0.0357723918 -0.016653129 -0.0321912187  0.015314280</span>
<span class="co">#&gt; [13,]  0.0076782994 -0.0150044557  0.022189722  0.0231125151 -0.007762236</span>
<span class="co">#&gt; [14,] -0.0384420068  0.0002507879  0.005470037  0.0279201353  0.008401150</span>
<span class="co">#&gt; [15,] -0.0099254593  0.0100428315  0.003683211 -0.0200110124 -0.004839124</span>
<span class="co">#&gt;              [,11]         [,12]         [,13]         [,14]        [,15]</span>
<span class="co">#&gt;  [1,] -0.029473039 -0.0343695736 -0.0091878186 -0.0078741671  0.014245647</span>
<span class="co">#&gt;  [2,]  0.008697755  0.0156212854  0.0274985081  0.0195851197  0.016953669</span>
<span class="co">#&gt;  [3,]  0.033477375  0.0201399064  0.0265091984 -0.0020492708  0.007235159</span>
<span class="co">#&gt;  [4,]  0.030718926 -0.0084790270 -0.0083937710 -0.0052228033 -0.015031420</span>
<span class="co">#&gt;  [5,]  0.037836005  0.0148636515  0.0126639318 -0.0051922696  0.009486863</span>
<span class="co">#&gt;  [6,] -0.006094876  0.0129599085  0.0076782994 -0.0384420068 -0.009925459</span>
<span class="co">#&gt;  [7,]  0.017278854 -0.0357723918 -0.0150044557  0.0002507879  0.010042832</span>
<span class="co">#&gt;  [8,] -0.012440456 -0.0166531294  0.0221897218  0.0054700372  0.003683211</span>
<span class="co">#&gt;  [9,]  0.017172462 -0.0321912187  0.0231125151  0.0279201353 -0.020011012</span>
<span class="co">#&gt; [10,] -0.012254129  0.0153142799 -0.0077622355  0.0084011497 -0.004839124</span>
<span class="co">#&gt; [11,]  0.542377832  0.0135553107  0.0050966377 -0.0148225069  0.016539498</span>
<span class="co">#&gt; [12,]  0.013555311  0.5162196177 -0.0001402986 -0.0097484912 -0.023043226</span>
<span class="co">#&gt; [13,]  0.005096638 -0.0001402986  0.4452252772 -0.0175478056  0.016157581</span>
<span class="co">#&gt; [14,] -0.014822507 -0.0097484912 -0.0175478056  0.4632630631 -0.009597961</span>
<span class="co">#&gt; [15,]  0.016539498 -0.0230432263  0.0161575813 -0.0095979613  0.472364431</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Ve</span>
<span class="co">#&gt;               [,1]         [,2]         [,3]         [,4]          [,5]</span>
<span class="co">#&gt;  [1,]  0.484429640  0.018952656  0.019647735  0.007917787 -0.0096009074</span>
<span class="co">#&gt;  [2,]  0.018952656  0.463872708  0.027556066 -0.010638466  0.0208389737</span>
<span class="co">#&gt;  [3,]  0.019647735  0.027556066  0.506822952  0.012382968 -0.0317597472</span>
<span class="co">#&gt;  [4,]  0.007917787 -0.010638466  0.012382968  0.486349251 -0.0108736702</span>
<span class="co">#&gt;  [5,] -0.009600907  0.020838974 -0.031759747 -0.010873670  0.5334386743</span>
<span class="co">#&gt;  [6,] -0.015882618  0.034663481 -0.013153992 -0.030089512  0.0001259003</span>
<span class="co">#&gt;  [7,]  0.062978214  0.020998955 -0.019396503 -0.033260494 -0.0072338583</span>
<span class="co">#&gt;  [8,]  0.041432980  0.008755777 -0.008387393  0.005283669 -0.0095590894</span>
<span class="co">#&gt;  [9,] -0.012465587 -0.002310092  0.005330635 -0.019870939 -0.0385871828</span>
<span class="co">#&gt; [10,]  0.023799028  0.031413786  0.027704980  0.026396731 -0.0408076555</span>
<span class="co">#&gt; [11,] -0.029473039  0.008697755  0.033477375  0.030718926  0.0378360054</span>
<span class="co">#&gt; [12,] -0.034369574  0.015621285  0.020139906 -0.008479027  0.0148636515</span>
<span class="co">#&gt; [13,] -0.009187819  0.027498508  0.026509198 -0.008393771  0.0126639318</span>
<span class="co">#&gt; [14,] -0.007874167  0.019585120 -0.002049271 -0.005222803 -0.0051922696</span>
<span class="co">#&gt; [15,]  0.014245647  0.016953669  0.007235159 -0.015031420  0.0094868625</span>
<span class="co">#&gt;                [,6]          [,7]         [,8]          [,9]        [,10]</span>
<span class="co">#&gt;  [1,] -0.0158826182  0.0629782136  0.041432980 -0.0124655873  0.023799028</span>
<span class="co">#&gt;  [2,]  0.0346634814  0.0209989549  0.008755777 -0.0023100924  0.031413786</span>
<span class="co">#&gt;  [3,] -0.0131539921 -0.0193965029 -0.008387393  0.0053306351  0.027704980</span>
<span class="co">#&gt;  [4,] -0.0300895119 -0.0332604942  0.005283669 -0.0198709393  0.026396731</span>
<span class="co">#&gt;  [5,]  0.0001259003 -0.0072338583 -0.009559089 -0.0385871828 -0.040807655</span>
<span class="co">#&gt;  [6,]  0.4854852358  0.0456633103 -0.006091857 -0.0009842558  0.004435829</span>
<span class="co">#&gt;  [7,]  0.0456633103  0.5124943401  0.054639955  0.0051256057 -0.006494508</span>
<span class="co">#&gt;  [8,] -0.0060918569  0.0546399553  0.540650519 -0.0291287183  0.012575213</span>
<span class="co">#&gt;  [9,] -0.0009842558  0.0051256057 -0.029128718  0.4942695974 -0.008134746</span>
<span class="co">#&gt; [10,]  0.0044358287 -0.0064945081  0.012575213 -0.0081347456  0.526579475</span>
<span class="co">#&gt; [11,] -0.0060948762  0.0172788543 -0.012440456  0.0171724624 -0.012254129</span>
<span class="co">#&gt; [12,]  0.0129599085 -0.0357723918 -0.016653129 -0.0321912187  0.015314280</span>
<span class="co">#&gt; [13,]  0.0076782994 -0.0150044557  0.022189722  0.0231125151 -0.007762236</span>
<span class="co">#&gt; [14,] -0.0384420068  0.0002507879  0.005470037  0.0279201353  0.008401150</span>
<span class="co">#&gt; [15,] -0.0099254593  0.0100428315  0.003683211 -0.0200110124 -0.004839124</span>
<span class="co">#&gt;              [,11]         [,12]         [,13]         [,14]        [,15]</span>
<span class="co">#&gt;  [1,] -0.029473039 -0.0343695736 -0.0091878186 -0.0078741671  0.014245647</span>
<span class="co">#&gt;  [2,]  0.008697755  0.0156212854  0.0274985081  0.0195851197  0.016953669</span>
<span class="co">#&gt;  [3,]  0.033477375  0.0201399064  0.0265091984 -0.0020492708  0.007235159</span>
<span class="co">#&gt;  [4,]  0.030718926 -0.0084790270 -0.0083937710 -0.0052228033 -0.015031420</span>
<span class="co">#&gt;  [5,]  0.037836005  0.0148636515  0.0126639318 -0.0051922696  0.009486863</span>
<span class="co">#&gt;  [6,] -0.006094876  0.0129599085  0.0076782994 -0.0384420068 -0.009925459</span>
<span class="co">#&gt;  [7,]  0.017278854 -0.0357723918 -0.0150044557  0.0002507879  0.010042832</span>
<span class="co">#&gt;  [8,] -0.012440456 -0.0166531294  0.0221897218  0.0054700372  0.003683211</span>
<span class="co">#&gt;  [9,]  0.017172462 -0.0321912187  0.0231125151  0.0279201353 -0.020011012</span>
<span class="co">#&gt; [10,] -0.012254129  0.0153142799 -0.0077622355  0.0084011497 -0.004839124</span>
<span class="co">#&gt; [11,]  0.542377832  0.0135553107  0.0050966377 -0.0148225069  0.016539498</span>
<span class="co">#&gt; [12,]  0.013555311  0.5162196177 -0.0001402986 -0.0097484912 -0.023043226</span>
<span class="co">#&gt; [13,]  0.005096638 -0.0001402986  0.4452252772 -0.0175478056  0.016157581</span>
<span class="co">#&gt; [14,] -0.014822507 -0.0097484912 -0.0175478056  0.4632630631 -0.009597961</span>
<span class="co">#&gt; [15,]  0.016539498 -0.0230432263  0.0161575813 -0.0095979613  0.472364431</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/limmbo2/topics/limmbo2">limmbo2</a></span>(<span class="dt">kinship =</span> kinship, <span class="dt">pheno =</span> pheno, <span class="dt">S =</span> <span class="dv">3</span>, <span class="dt">seed =</span> <span class="dv">1</span>) -&gt;<span class="st"> </span>li_out)
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   3.823   1.117  20.541</span>
li_out
<span class="co">#&gt; $Vg</span>
<span class="co">#&gt;               [,1]          [,2]         [,3]         [,4]         [,5]</span>
<span class="co">#&gt;  [1,]  0.483574431  0.0181532388  0.019866732  0.007563143 -0.009200837</span>
<span class="co">#&gt;  [2,]  0.018153239  0.4674791547  0.025922755 -0.008596321  0.018523921</span>
<span class="co">#&gt;  [3,]  0.019866732  0.0259227551  0.506351951  0.011655921 -0.030903260</span>
<span class="co">#&gt;  [4,]  0.007563143 -0.0085963210  0.011655921  0.486270118 -0.011859345</span>
<span class="co">#&gt;  [5,] -0.009200837  0.0185239206 -0.030903260 -0.011859345  0.533496653</span>
<span class="co">#&gt;  [6,] -0.015317244  0.0314104305 -0.012023955 -0.031437050  0.001714660</span>
<span class="co">#&gt;  [7,]  0.063052118  0.0196723819 -0.018910027 -0.033756602 -0.006577592</span>
<span class="co">#&gt;  [8,]  0.041610620  0.0071247419 -0.007810291  0.004554820 -0.008731937</span>
<span class="co">#&gt;  [9,] -0.012950197  0.0007636194  0.004255135 -0.018461510 -0.040036949</span>
<span class="co">#&gt; [10,]  0.023931977  0.0302306548  0.028029771  0.025842797 -0.040160460</span>
<span class="co">#&gt; [11,] -0.029139731  0.0070690929  0.033962575  0.029935582  0.038558742</span>
<span class="co">#&gt; [12,] -0.034928852  0.0193918058  0.018776745 -0.006767190  0.012927783</span>
<span class="co">#&gt; [13,] -0.009307086  0.0282744523  0.026160216 -0.008002548  0.012217058</span>
<span class="co">#&gt; [14,] -0.007684959  0.0185133850 -0.001688285 -0.005668764 -0.004666456</span>
<span class="co">#&gt; [15,]  0.014065399  0.0178080145  0.006910220 -0.014601575  0.009020057</span>
<span class="co">#&gt;               [,6]          [,7]         [,8]          [,9]        [,10]</span>
<span class="co">#&gt;  [1,] -0.015317244  0.0630521185  0.041610620 -0.0129501969  0.023931977</span>
<span class="co">#&gt;  [2,]  0.031410430  0.0196723819  0.007124742  0.0007636194  0.030230655</span>
<span class="co">#&gt;  [3,] -0.012023955 -0.0189100271 -0.007810291  0.0042551351  0.028029771</span>
<span class="co">#&gt;  [4,] -0.031437050 -0.0337566022  0.004554820 -0.0184615103  0.025842797</span>
<span class="co">#&gt;  [5,]  0.001714660 -0.0065775918 -0.008731937 -0.0400369495 -0.040160460</span>
<span class="co">#&gt;  [6,]  0.486749375  0.0464595415 -0.004949787 -0.0031311147  0.005205879</span>
<span class="co">#&gt;  [7,]  0.046459541  0.5118225493  0.054974848  0.0042482918 -0.006165910</span>
<span class="co">#&gt;  [8,] -0.004949787  0.0549748484  0.540142183 -0.0301550864  0.012943197</span>
<span class="co">#&gt;  [9,] -0.003131115  0.0042482918 -0.030155086  0.4953526807 -0.008869961</span>
<span class="co">#&gt; [10,]  0.005205879 -0.0061659102  0.012943197 -0.0088699613  0.525784060</span>
<span class="co">#&gt; [11,] -0.004954366  0.0176954368 -0.011841566  0.0160461130 -0.011832275</span>
<span class="co">#&gt; [12,]  0.010266896 -0.0367675150 -0.017968707 -0.0295465136  0.014346553</span>
<span class="co">#&gt; [13,]  0.007075056 -0.0152073878  0.021843247  0.0236275044 -0.007950438</span>
<span class="co">#&gt; [14,] -0.037637110  0.0005403889  0.005823298  0.0271626302  0.008634853</span>
<span class="co">#&gt; [15,] -0.010528251  0.0097691829  0.003358354 -0.0193638851 -0.005047356</span>
<span class="co">#&gt;              [,11]         [,12]         [,13]         [,14]        [,15]</span>
<span class="co">#&gt;  [1,] -0.029139731 -0.0349288516 -0.0093070862 -0.0076849591  0.014065399</span>
<span class="co">#&gt;  [2,]  0.007069093  0.0193918058  0.0282744523  0.0185133850  0.017808015</span>
<span class="co">#&gt;  [3,]  0.033962575  0.0187767450  0.0261602157 -0.0016882846  0.006910220</span>
<span class="co">#&gt;  [4,]  0.029935582 -0.0067671895 -0.0080025484 -0.0056687644 -0.014601575</span>
<span class="co">#&gt;  [5,]  0.038558742  0.0129277835  0.0122170578 -0.0046664563  0.009020057</span>
<span class="co">#&gt;  [6,] -0.004954366  0.0102668963  0.0070750558 -0.0376371097 -0.010528251</span>
<span class="co">#&gt;  [7,]  0.017695437 -0.0367675150 -0.0152073878  0.0005403889  0.009769183</span>
<span class="co">#&gt;  [8,] -0.011841566 -0.0179687071  0.0218432467  0.0058232981  0.003358354</span>
<span class="co">#&gt;  [9,]  0.016046113 -0.0295465136  0.0236275044  0.0271626302 -0.019363885</span>
<span class="co">#&gt; [10,] -0.011832275  0.0143465531 -0.0079504384  0.0086348531 -0.005047356</span>
<span class="co">#&gt; [11,]  0.541880829  0.0121757147  0.0047883765 -0.0144251689  0.016187238</span>
<span class="co">#&gt; [12,]  0.012175715  0.5183812296  0.0005622393 -0.0105893915 -0.022244957</span>
<span class="co">#&gt; [13,]  0.004788377  0.0005622393  0.4444836594 -0.0176983893  0.016286466</span>
<span class="co">#&gt; [14,] -0.014425169 -0.0105893915 -0.0176983893  0.4625616902 -0.009778885</span>
<span class="co">#&gt; [15,]  0.016187238 -0.0222449569  0.0162864661 -0.0097788850  0.471607698</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Ve</span>
<span class="co">#&gt;               [,1]          [,2]         [,3]         [,4]         [,5]</span>
<span class="co">#&gt;  [1,]  0.483574431  0.0181532388  0.019866732  0.007563143 -0.009200837</span>
<span class="co">#&gt;  [2,]  0.018153239  0.4674791547  0.025922755 -0.008596321  0.018523921</span>
<span class="co">#&gt;  [3,]  0.019866732  0.0259227551  0.506351951  0.011655921 -0.030903260</span>
<span class="co">#&gt;  [4,]  0.007563143 -0.0085963210  0.011655921  0.486270118 -0.011859345</span>
<span class="co">#&gt;  [5,] -0.009200837  0.0185239206 -0.030903260 -0.011859345  0.533496653</span>
<span class="co">#&gt;  [6,] -0.015317244  0.0314104305 -0.012023955 -0.031437050  0.001714660</span>
<span class="co">#&gt;  [7,]  0.063052118  0.0196723819 -0.018910027 -0.033756602 -0.006577592</span>
<span class="co">#&gt;  [8,]  0.041610620  0.0071247419 -0.007810291  0.004554820 -0.008731937</span>
<span class="co">#&gt;  [9,] -0.012950197  0.0007636194  0.004255135 -0.018461510 -0.040036949</span>
<span class="co">#&gt; [10,]  0.023931977  0.0302306548  0.028029771  0.025842797 -0.040160460</span>
<span class="co">#&gt; [11,] -0.029139731  0.0070690929  0.033962575  0.029935582  0.038558742</span>
<span class="co">#&gt; [12,] -0.034928852  0.0193918058  0.018776745 -0.006767190  0.012927783</span>
<span class="co">#&gt; [13,] -0.009307086  0.0282744523  0.026160216 -0.008002548  0.012217058</span>
<span class="co">#&gt; [14,] -0.007684959  0.0185133850 -0.001688285 -0.005668764 -0.004666456</span>
<span class="co">#&gt; [15,]  0.014065399  0.0178080145  0.006910220 -0.014601575  0.009020057</span>
<span class="co">#&gt;               [,6]          [,7]         [,8]          [,9]        [,10]</span>
<span class="co">#&gt;  [1,] -0.015317244  0.0630521185  0.041610620 -0.0129501969  0.023931977</span>
<span class="co">#&gt;  [2,]  0.031410430  0.0196723819  0.007124742  0.0007636194  0.030230655</span>
<span class="co">#&gt;  [3,] -0.012023955 -0.0189100271 -0.007810291  0.0042551351  0.028029771</span>
<span class="co">#&gt;  [4,] -0.031437050 -0.0337566022  0.004554820 -0.0184615103  0.025842797</span>
<span class="co">#&gt;  [5,]  0.001714660 -0.0065775918 -0.008731937 -0.0400369495 -0.040160460</span>
<span class="co">#&gt;  [6,]  0.486749375  0.0464595415 -0.004949787 -0.0031311147  0.005205879</span>
<span class="co">#&gt;  [7,]  0.046459541  0.5118225493  0.054974848  0.0042482918 -0.006165910</span>
<span class="co">#&gt;  [8,] -0.004949787  0.0549748484  0.540142183 -0.0301550864  0.012943197</span>
<span class="co">#&gt;  [9,] -0.003131115  0.0042482918 -0.030155086  0.4953526807 -0.008869961</span>
<span class="co">#&gt; [10,]  0.005205879 -0.0061659102  0.012943197 -0.0088699613  0.525784060</span>
<span class="co">#&gt; [11,] -0.004954366  0.0176954368 -0.011841566  0.0160461130 -0.011832275</span>
<span class="co">#&gt; [12,]  0.010266896 -0.0367675150 -0.017968707 -0.0295465136  0.014346553</span>
<span class="co">#&gt; [13,]  0.007075056 -0.0152073878  0.021843247  0.0236275044 -0.007950438</span>
<span class="co">#&gt; [14,] -0.037637110  0.0005403889  0.005823298  0.0271626302  0.008634853</span>
<span class="co">#&gt; [15,] -0.010528251  0.0097691829  0.003358354 -0.0193638851 -0.005047356</span>
<span class="co">#&gt;              [,11]         [,12]         [,13]         [,14]        [,15]</span>
<span class="co">#&gt;  [1,] -0.029139731 -0.0349288516 -0.0093070862 -0.0076849591  0.014065399</span>
<span class="co">#&gt;  [2,]  0.007069093  0.0193918058  0.0282744523  0.0185133850  0.017808015</span>
<span class="co">#&gt;  [3,]  0.033962575  0.0187767450  0.0261602157 -0.0016882846  0.006910220</span>
<span class="co">#&gt;  [4,]  0.029935582 -0.0067671895 -0.0080025484 -0.0056687644 -0.014601575</span>
<span class="co">#&gt;  [5,]  0.038558742  0.0129277835  0.0122170578 -0.0046664563  0.009020057</span>
<span class="co">#&gt;  [6,] -0.004954366  0.0102668963  0.0070750558 -0.0376371097 -0.010528251</span>
<span class="co">#&gt;  [7,]  0.017695437 -0.0367675150 -0.0152073878  0.0005403889  0.009769183</span>
<span class="co">#&gt;  [8,] -0.011841566 -0.0179687071  0.0218432467  0.0058232981  0.003358354</span>
<span class="co">#&gt;  [9,]  0.016046113 -0.0295465136  0.0236275044  0.0271626302 -0.019363885</span>
<span class="co">#&gt; [10,] -0.011832275  0.0143465531 -0.0079504384  0.0086348531 -0.005047356</span>
<span class="co">#&gt; [11,]  0.541880829  0.0121757147  0.0047883765 -0.0144251689  0.016187238</span>
<span class="co">#&gt; [12,]  0.012175715  0.5183812296  0.0005622393 -0.0105893915 -0.022244957</span>
<span class="co">#&gt; [13,]  0.004788377  0.0005622393  0.4444836594 -0.0176983893  0.016286466</span>
<span class="co">#&gt; [14,] -0.014425169 -0.0105893915 -0.0176983893  0.4625616902 -0.009778885</span>
<span class="co">#&gt; [15,]  0.016187238 -0.0222449569  0.0162864661 -0.0097788850  0.471607698</span></code></pre></div>
</div>
<div id="use-nontrivial-kinship-with-trivariate-phenotype" class="section level2">
<h2 class="hasAnchor">
<a href="#use-nontrivial-kinship-with-trivariate-phenotype" class="anchor"></a>Use nontrivial kinship with trivariate phenotype</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="dv">500</span>
A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(n <span class="op">^</span><span class="st"> </span><span class="dv">2</span>), <span class="dt">ncol =</span> n) 
kinship &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">t</span>(A) <span class="op">%*%</span><span class="st"> </span>A, <span class="dv">6</span>)
pheno &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">1500</span>), <span class="dt">nrow =</span> <span class="dv">500</span>)

<span class="kw">system.time</span>(<span class="kw"><a href="../reference/calc_covs.html">calc_covs</a></span>(pheno, kinship) -&gt;<span class="st"> </span>cc_out)
<span class="co">#&gt;      user    system   elapsed </span>
<span class="co">#&gt;  2761.339    25.882 40147.513</span>
cc_out
<span class="co">#&gt; $Vg</span>
<span class="co">#&gt;               [,1]          [,2]          [,3]</span>
<span class="co">#&gt; [1,]  0.0008739315  0.0005288488 -0.0001704406</span>
<span class="co">#&gt; [2,]  0.0005288488  0.0004721331 -0.0002310818</span>
<span class="co">#&gt; [3,] -0.0001704406 -0.0002310818  0.0001425138</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Ve</span>
<span class="co">#&gt;             [,1]         [,2]         [,3]</span>
<span class="co">#&gt; [1,]  1.03881128 -0.045516500 -0.030041173</span>
<span class="co">#&gt; [2,] -0.04551650  0.987353497 -0.008387006</span>
<span class="co">#&gt; [3,] -0.03004117 -0.008387006  0.926094374</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/limmbo2/topics/limmbo2">limmbo2</a></span>(<span class="dt">kinship =</span> kinship, <span class="dt">pheno =</span> pheno, <span class="dt">S =</span> <span class="dv">3</span>, <span class="dt">seed =</span> <span class="dv">1</span>) -&gt;<span class="st"> </span>li_out)
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   0.213   0.229   5.263</span>
li_out
<span class="co">#&gt; $Vg</span>
<span class="co">#&gt;               [,1]          [,2]         [,3]</span>
<span class="co">#&gt; [1,]  2.000000e-04 -3.409724e-16 1.229112e-15</span>
<span class="co">#&gt; [2,] -3.409724e-16  2.000000e-04 7.998803e-17</span>
<span class="co">#&gt; [3,]  1.229112e-15  7.998803e-17 2.000000e-04</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Ve</span>
<span class="co">#&gt;             [,1]        [,2]        [,3]</span>
<span class="co">#&gt; [1,]  1.07082081 -0.02365170 -0.03737009</span>
<span class="co">#&gt; [2,] -0.02365170  1.00321317 -0.01730728</span>
<span class="co">#&gt; [3,] -0.03737009 -0.01730728  0.92835365</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#background">Background</a></li>
      <li><a href="#goals">Goals</a></li>
      <li><a href="#first-gemma2-method">First, <code>gemma2</code> method:</a></li>
      <li><a href="#dimensional-phenotype-comparison-of-calc_covs-and-limmbo2">5-dimensional phenotype comparison of <code><a href="--/reference/calc_covs-html">calc_covs()</a></code> and <code><a href="http://www-rdocumentation-org/packages/limmbo2/topics/limmbo2">limmbo2()</a></code></a></li>
      <li><a href="#increase-sample-size-to-500">Increase sample size to 500</a></li>
      <li><a href="#phenotypes">15 phenotypes</a></li>
      <li><a href="#use-nontrivial-kinship-with-trivariate-phenotype">Use nontrivial kinship with trivariate phenotype</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Frederick Boehm.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
